#include "mpc_const.h" 

const real_t HoL[] = { /* Quadratic term (Hessian) matrix of QP over Lipschitz constant. */
0.0101664148699, 0.00741285105904, 0.00577109778917, 0.00463464253108, 0.00353615545586, 0.00245070334194, 0.0014965977651, 0.000760986608775, 0.000285606093213, 5.91538381655e-05, 
0.00741285105904, 0.00767211341109, 0.00520097217219, 0.00384153864073, 0.00298646917762, 0.00216817432654, 0.0013652058382, 0.000703388784569, 0.000266833363016, 5.60689932977e-05, 
0.00577109778917, 0.00520097217219, 0.00571001927539, 0.00348854980856, 0.00237800584684, 0.00177095401964, 0.00120282600908, 0.000658043374384, 0.000258638121929, 5.39700396616e-05, 
0.00463464253108, 0.00384153864073, 0.00348854980856, 0.00421460860265, 0.00220951471815, 0.0013147952332, 0.000925600292103, 0.000581611907333, 0.000262622155112, 6.21078813472e-05, 
0.00353615545586, 0.00298646917762, 0.00237800584684, 0.00220951471815, 0.00311948283474, 0.00129791763218, 0.000588839366713, 0.000390902022283, 0.000238242848626, 8.40000283312e-05, 
0.00245070334194, 0.00216817432654, 0.00177095401964, 0.0013147952332, 0.00129791763218, 0.00235902204446, 0.000691019782583, 0.000142146133956, 0.000104838370849, 8.19868262029e-05, 
0.0014965977651, 0.0013652058382, 0.00120282600908, 0.000925600292103, 0.000588839366713, 0.000691019782583, 0.00187340795255, 0.000332315752545, -9.00967258326e-05, -2.85105825323e-05, 
0.000760986608775, 0.000703388784569, 0.000658043374384, 0.000581611907333, 0.000390902022283, 0.000142146133956, 0.000332315752545, 0.00159558198699, 0.000122631342823, -0.000220766033822, 
0.000285606093213, 0.000266833363016, 0.000258638121929, 0.000262622155112, 0.000238242848626, 0.000104838370849, -9.00967258326e-05, 0.000122631342823, 0.00136870479632, -4.43739645415e-05, 
5.91538381655e-05, 5.60689932977e-05, 5.39700396616e-05, 6.21078813472e-05, 8.40000283312e-05, 8.19868262029e-05, -2.85105825323e-05, -0.000220766033822, -4.43739645415e-05, 0.00119127172254, 
 
};
const real_t GoL[] = { /* Linear term matrix of the QP, over Lipschitz constant. */
0.00587254003948, -0.00812092104905, -0.00127836304933, -1.61472319567e-05, 0.0, 
0.00481099131375, -0.006756173661, -0.000988704192947, -1.27962150545e-05, 0.0, 
0.00378812576758, -0.00544948566913, -0.000803655219188, -9.83226975203e-06, 0.0, 
0.00291862547067, -0.00422560960006, -0.000642828260427, -7.2555287386e-06, 0.0, 
0.00215902624291, -0.00310842683279, -0.000481122021417, -5.06447197966e-06, 0.0, 
0.00148253738483, -0.00212124850095, -0.000329205433663, -3.25572983249e-06, 0.0, 
0.00090413405502, -0.00129050150214, -0.00020016012893, -1.83046059794e-06, 0.0, 
0.000455987810631, -0.000650938333102, -0.000101511849094, -8.06777043303e-07, 0.0, 
0.000166344746607, -0.000237492876122, -3.77526634176e-05, -2.11803282029e-07, 0.0, 
3.21496605146e-05, -4.58295339341e-05, -7.63413114048e-06, -8.26388235036e-09, 0.0, 

};
const real_t Bh_T[] = { /* Extended input matrix (used for reference tracking). */
-1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 0.171601431217, -1.245388233, 0.317014258298, -222.96036599, 0.0, 0.0978320331064, -1.22358372436, -0.125879926297, -310.426546105, 0.0, 0.000979426435084, -1.29401935224, -0.114341930548, -393.947728563, 0.0, -0.0201993512553, -1.32528643206, -0.0168472075231, -477.216630732, 0.0, -0.00785785216505, -1.32232107417, 0.017659727508, -561.219447956, 0.0, 0.00127044920217, -1.31462345299, 0.010232186592, -645.5533318, 0.0, 0.00213348061335, -1.3123309437, 0.000162982729497, -729.858315674, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 0.171601431217, -1.245388233, 0.317014258298, -222.96036599, 0.0, 0.0978320331064, -1.22358372436, -0.125879926297, -310.426546105, 0.0, 0.000979426435084, -1.29401935224, -0.114341930548, -393.947728563, 0.0, -0.0201993512553, -1.32528643206, -0.0168472075231, -477.216630732, 0.0, -0.00785785216505, -1.32232107417, 0.017659727508, -561.219447956, 0.0, 0.00127044920217, -1.31462345299, 0.010232186592, -645.5533318, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 0.171601431217, -1.245388233, 0.317014258298, -222.96036599, 0.0, 0.0978320331064, -1.22358372436, -0.125879926297, -310.426546105, 0.0, 0.000979426435084, -1.29401935224, -0.114341930548, -393.947728563, 0.0, -0.0201993512553, -1.32528643206, -0.0168472075231, -477.216630732, 0.0, -0.00785785216505, -1.32232107417, 0.017659727508, -561.219447956, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 0.171601431217, -1.245388233, 0.317014258298, -222.96036599, 0.0, 0.0978320331064, -1.22358372436, -0.125879926297, -310.426546105, 0.0, 0.000979426435084, -1.29401935224, -0.114341930548, -393.947728563, 0.0, -0.0201993512553, -1.32528643206, -0.0168472075231, -477.216630732, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 0.171601431217, -1.245388233, 0.317014258298, -222.96036599, 0.0, 0.0978320331064, -1.22358372436, -0.125879926297, -310.426546105, 0.0, 0.000979426435084, -1.29401935224, -0.114341930548, -393.947728563, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 0.171601431217, -1.245388233, 0.317014258298, -222.96036599, 0.0, 0.0978320331064, -1.22358372436, -0.125879926297, -310.426546105, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 0.171601431217, -1.245388233, 0.317014258298, -222.96036599, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, -0.156119365263, -1.61966194101, 1.16983101174, -129.586498647, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, -1.09740391867, -2.19027243899, 0.599922342864, -44.3312963663, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2346445, -1.43828223, -4.48282454, -1.79989043, 1.0, 

};
const real_t E[] = { /* Linear factor (prediction matrix) of 2-sided state constraint. */
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-1.43828223, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-26.106356986, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-2.19027243899, -1.43828223, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-140.105744305, -26.106356986, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, -1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-1.61966194101, -2.19027243899, -1.43828223, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-187.62615821, -140.105744305, -26.106356986, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, -1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-1.245388233, -1.61966194101, -2.19027243899, -1.43828223, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-181.658074953, -187.62615821, -140.105744305, -26.106356986, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, -1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
-1.22358372436, -1.245388233, -1.61966194101, -2.19027243899, -1.43828223, 0.0, 0.0, 0.0, 0.0, 0.0, 
-169.405500107, -181.658074953, -187.62615821, -140.105744305, -26.106356986, 0.0, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, -1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 
-1.29401935224, -1.22358372436, -1.245388233, -1.61966194101, -2.19027243899, -1.43828223, 0.0, 0.0, 0.0, 0.0, 
-166.018843426, -169.405500107, -181.658074953, -187.62615821, -140.105744305, -26.106356986, 0.0, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 1.0, 0.0, 0.0, 0.0, 
-1.32528643206, -1.29401935224, -1.22358372436, -1.245388233, -1.61966194101, -2.19027243899, -1.43828223, 0.0, 0.0, 0.0, 
-167.312163759, -166.018843426, -169.405500107, -181.658074953, -187.62615821, -140.105744305, -26.106356986, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 1.0, 0.0, 0.0, 
-1.32232107417, -1.32528643206, -1.29401935224, -1.22358372436, -1.245388233, -1.61966194101, -2.19027243899, -1.43828223, 0.0, 0.0, 
-168.514185061, -167.312163759, -166.018843426, -169.405500107, -181.658074953, -187.62615821, -140.105744305, -26.106356986, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 1.0, 0.0, 
-1.31462345299, -1.32232107417, -1.32528643206, -1.29401935224, -1.22358372436, -1.245388233, -1.61966194101, -2.19027243899, -1.43828223, 0.0, 
-168.697598261, -168.514185061, -167.312163759, -166.018843426, -169.405500107, -181.658074953, -187.62615821, -140.105744305, -26.106356986, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 1.0, 
-1.3123309437, -1.31462345299, -1.32232107417, -1.32528643206, -1.29401935224, -1.22358372436, -1.245388233, -1.61966194101, -2.19027243899, -1.43828223, 
-168.514339198, -168.697598261, -168.514185061, -167.312163759, -166.018843426, -169.405500107, -181.658074953, -187.62615821, -140.105744305, -26.106356986, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 

};
const real_t Kx_Ai[] = { /* Prediction component of the state constraint bound. */
0.0, 1.0, 0.0, 0.0, 0.0, 
-128.2, 128.2, 0.0, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, -1.0, 
-0.37221757, 1.0, 0.27026411, 0.0, 0.0, 
-78.481183704, 128.2, 11.736868968, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.729120084453, 1.0, 0.241272841144, 0.0, 0.0, 
-78.171176929, 128.2, 22.2520397772, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.786058571003, 1.0, 0.17346404871, 0.0, 0.0, 
-88.5077273611, 128.2, 23.7675757572, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.732584897608, 1.0, 0.153872497757, 0.0, 0.0, 
-92.4886008586, 128.2, 22.1307480805, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.700355996234, 1.0, 0.160708453923, 0.0, 0.0, 
-91.823249156, 128.2, 21.1920253034, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.699390539318, 1.0, 0.167417412412, 0.0, 0.0, 
-90.7341735272, 128.2, 21.1805814244, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.705801324406, 1.0, 0.168521556152, 0.0, 0.0, 
-90.4615083338, 128.2, 21.3736241617, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.708432856328, 1.0, 0.167529187452, 0.0, 0.0, 
-90.5872087639, 128.2, 21.4491588034, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.708081787227, 1.0, 0.16692109878, 0.0, 0.0, 
-90.6921577662, 128.2, 21.4371832387, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 
-0.70739548361, 1.0, 0.166899400318, 0.0, 0.0, 
-90.7054844871, 128.2, 21.4167645776, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 

};

const real_t u_lb[] = { /* Left (lower) constraint of the inputs for condensed QP. */
-0.262, 
-0.262, 
-0.262, 
-0.262, 
-0.262, 
-0.262, 
-0.262, 
-0.262, 
-0.262, 
-0.262, 

};
const real_t u_ub[] = { /* Right (upper) constraint of the inputs for condensed QP. */
0.262, 
0.262, 
0.262, 
0.262, 
0.262, 
0.262, 
0.262, 
0.262, 
0.262, 
0.262, 

};
const real_t e_lb[] = { /* Left (lower) constraint of the states for condensed QP. */
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 
-0.349, 
-30.0, 
-0.262, 

};
const real_t e_ub[] = { /* Right (upper) constraint of the states for condensed QP. */
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 
0.349, 
30.0, 
0.262, 

};

const real_t nu = 0.937730835141; /* Fast gradient extra step constant */
const real_t mu = 100.0; /* Augmented Lagrange multiplier penalty parameter. */
const real_t Linv = 9.02251259937e-09; /* Inverse of gradient Lipschitz constant (1/L) */

/* state dependent variables */
real_t gxoL[MPC_HOR_INPUTS];  /* gradient vector as a function of the current state */
real_t zx_lb[MPC_HOR_MXCONSTRS];  /* mixed constraint lower bound as function of current state */
real_t zx_ub[MPC_HOR_MXCONSTRS];  /* mixed constraint upper bound as function of current state */

/* reference dependent variables */
real_t groL[MPC_HOR_INPUTS];

/* MPC system: state-space and weighting matrices */
const real_t Q[] = {  /* State weighting matrix */
1227.72146, 0.0, 0.0, 0.0, 0.0, 
0.0, 3123.42118, 0.0, 0.0, 0.0, 
0.0, 0.0, 6121.07095, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.50887435, 0.0, 
0.0, 0.0, 0.0, 0.0, 345.774408, 

};
const real_t R[] = {   /* Input weighting matrix */
345.774408, 

};
const real_t P[] = {   /* Terminal state weighting matrix */
1227.72146, 0.0, 0.0, 0.0, 0.0, 
0.0, 3123.42118, 0.0, 0.0, 0.0, 
0.0, 0.0, 6121.07095, 0.0, 0.0, 
0.0, 0.0, 0.0, 0.50887435, 0.0, 
0.0, 0.0, 0.0, 0.0, 345.774408, 

};
const real_t K[] = {   /* Linear quadratic regulator gain matrix */
0, 

};
const real_t Ad[] = {   /* Discrete-time system matrix */
0.23996015, 0.0, 0.17871287, 0.0, 0.0, 
-0.37221757, 1.0, 0.27026411, 0.0, 0.0, 
-0.99008755, 0.0, 0.13885973, 0.0, 0.0, 
-48.93540655, 64.1, 2.39923411, 1.0, 0.0, 
0.0, 0.0, 0.0, 0.0, 0.0, 

};
const real_t Bd[] = {   /* Discrete-time input matrix */
-1.2346445, 
-1.43828223, 
-4.48282454, 
-1.79989043, 
1.0, 

};
const real_t dt = 0.5;


/* User variables created with appropriate size */
real_t u_opt[MPC_HOR_INPUTS];  /* Optimal input */
real_t l_opt[MPC_HOR_MXCONSTRS];  /* Optimal multiplier */
real_t x_trj[MPC_HOR_STATES + MPC_STATES];  /* State trajectory for u_opt */
real_t u_ini[MPC_HOR_INPUTS];  /* Initial guess input */
real_t l_ini[MPC_HOR_MXCONSTRS];  /* Initial guess multiplier */

/* Always check this declarations match the structure definitions */
struct mpc_conf conf = {1, 1, 0};

struct mpc_qpx qpx = {HoL, gxoL, E, u_lb, u_ub, zx_lb, zx_ub,
		MPC_HOR_INPUTS, MPC_HOR_MXCONSTRS};

struct mpc_sys sys = {Ad, Bd, &dt};

struct mpc_wmx wmx = {Q, R, P,};

struct mpc_lqr lqr = {K, P,};

struct mpc_fgm fgm = {u_ini, gxoL, groL, &(conf.in_iter),
			HoL, GoL, Bh_T, u_lb, u_ub, &nu,
			MPC_HOR, MPC_STATES, MPC_INPUTS, MPC_HOR_INPUTS, MPC_HOR_STATES};

struct mpc_alm alm = {&fgm, l_ini, zx_lb, zx_ub, &(conf.ex_iter),
			&mu,
			E, Kx_Ai, e_lb, e_ub,
			&Linv, 
			MPC_STATES, MPC_MXCONSTRS, MPC_HOR_INPUTS, MPC_HOR_MXCONSTRS};

struct mpc_ctl ctl = {&conf, &qpx, &sys, &wmx, &lqr, &alm,
			u_opt, l_opt, x_trj, 0, 0, u_ini, l_ini};

